const mensagem_enorme = `**Análise Realizada de Curto Prazo**

**OBSERVAÇÃO**: A criptomoeda BTC mostra-se equilibrada, **revela** nossa inteligência artificial. Refinamentos nas alocações atuais podem desbloquear valorizações futuras, de acordo com análises de tendência. Aguarde as propostas de nossa I.A para realocações ao término desta análise.

OBSERVAÇÃO: A criptomoeda ETH mostra-se equilibrada, revela nossa inteligência artificial. Refinamentos nas alocações atuais podem desbloquear valorizações futuras, de acordo com análises de tendência. Aguarde as propostas de nossa I.A para realocações ao término desta análise.

ANÁLISE: A criptomoeda XRP **encontra-se estável**, segundo nossa inteligência **artificial**. Ajustes estratégicos nas alocações podem ser benéficos para aproveitar futuras oportunidades de crescimento, baseando-se em projeções de mercado. Explore as sugestões de realocação preparadas pela nossa I.A no encerramento desta análise.


**Análise Realizada de Médio Prazo**

    CUIDADO EXTREMO! Nossa inteligência artificial aponta a criptomoeda  como altamente valorizada, após um exame detalhado de variáveis como indicadores de mercado, popularidade em redes e análises emocionais. Vemos uma grande oportunidade para otimizar ganhos e reconsiderar estratégias de investimento. Esta análise sugere a possibilidade de redefinir o portfólio para maximizar o potencial de crescimento. Aguarde as sugestões de nossa I.A para ajustes no final deste relatório.

PRESTE ATENÇÃO! De acordo com a nossa análise de I.A, a criptomoeda ETH está em uma trajetória de crescimento estável. Agora pode ser o momento ideal para reavaliar e ajustar as posições de investimento atuais, com o objetivo de capturar ganhos e realocar para ativos com maior potencial. As recomendações para ajustes na carteira serão disponibilizadas ao concluir esta análise.

OLHAR CRÍTICO! A análise de nossa inteligência artificial sinaliza que a criptomoeda XRP vem apresentando um desempenho forte. Avaliar a redistribuição das alocações pode ser uma jogada inteligente para proteger os lucros e reinvestir em áreas com perspectivas de alta valorização. Aguarde as orientações de rebalanceamento sugeridas ao fim desta análise.


**Análise Realizada de Longo Prazo**

Extrema CAUTELA! A análise de nossa inteligência artificial, apresenta a criptomoeda  com um patamar de extrema valorização. Baseando-se em diversos dados e informações, dentre elas: Indicadores, menções em redes sociais, análise de sentimento e várias outras, nossa inteligência artificial enxerga uma possibilidade de captura de lucros e reavaliação estratégica das posições atuais para esta cripto. Esse movimento poderia trazer novas oportunidades para o portfólio, buscando oportunidades com maior margem de crescimento. Nossa I.A irá te apresentar uma possibilidade de rebalanceamento ao final desta análise.

ALERTA MÁXIMO! A avaliação feita pela nossa I.A destaca a criptomoeda  num nível de valorização surpreendente. A partir de uma ampla gama de dados, incluindo análises de mercado, menções sociais e sentimentos, identificamos um forte potencial para a realização de lucros e ajustes estratégicos nas alocações atuais. Esta pode ser uma chance de diversificar o portfólio com ativos de alto crescimento. Fique atento às recomendações de rebalanceamento ao concluir esta análise.

ANÁLISE: A criptomoeda XRP encontra-se estável, segundo nossa inteligência artificial. Ajustes estratégicos nas alocações podem ser benéficos para aproveitar futuras oportunidades de crescimento, baseando-se em projeções de mercado. Explore as sugestões de realocação preparadas pela nossa I.A no encerramento desta análise.


Estas sugestões de ajustes não constitui uma recomendação direta de investimento.


**Análise Realizada de Longo Prazo**

Extrema CAUTELA! A análise de nossa inteligência artificial, apresenta a criptomoeda  com um patamar de extrema valorização. Baseando-se em diversos dados e informações, dentre elas: Indicadores, menções em redes sociais, análise de sentimento e várias outras, nossa inteligência artificial enxerga uma possibilidade de captura de lucros e reavaliação estratégica das posições atuais para esta cripto. Esse movimento poderia trazer novas oportunidades para o portfólio, buscando oportunidades com maior margem de crescimento. Nossa I.A irá te apresentar uma possibilidade de rebalanceamento ao final desta análise.

ALERTA MÁXIMO! A avaliação feita pela nossa I.A destaca a criptomoeda  num nível de valorização surpreendente. A partir de uma ampla gama de dados, incluindo análises de mercado, menções sociais e sentimentos, identificamos um forte potencial para a realização de lucros e ajustes estratégicos nas alocações atuais. Esta pode ser uma chance de diversificar o portfólio com ativos de alto crescimento. Fique atento às recomendações de rebalanceamento ao concluir esta análise.

ANÁLISE: A criptomoeda XRP encontra-se estável, segundo nossa inteligência artificial. Ajustes estratégicos nas alocações podem ser benéficos para aproveitar futuras oportunidades de crescimento, baseando-se em projeções de mercado. Explore as sugestões de realocação preparadas pela nossa I.A no encerramento desta análise.


Estas sugestões de ajustes não constitui uma recomendação direta de investimento.


**Análise Realizada de Longo Prazo**

Extrema CAUTELA! A análise de nossa inteligência artificial, apresenta a criptomoeda  com um patamar de extrema valorização. Baseando-se em diversos dados e informações, dentre elas: Indicadores, menções em redes sociais, análise de sentimento e várias outras, nossa inteligência artificial enxerga uma possibilidade de captura de lucros e reavaliação estratégica das posições atuais para esta cripto. Esse movimento poderia trazer novas oportunidades para o portfólio, buscando oportunidades com maior margem de crescimento. Nossa I.A irá te apresentar uma possibilidade de rebalanceamento ao final desta análise.

ALERTA MÁXIMO! A avaliação feita pela nossa I.A destaca a criptomoeda  num nível de valorização surpreendente. A partir de uma ampla gama de dados, incluindo análises de mercado, menções sociais e sentimentos, identificamos um forte potencial para a realização de lucros e ajustes estratégicos nas alocações atuais. Esta pode ser uma chance de diversificar o portfólio com ativos de alto crescimento. Fique atento às recomendações de rebalanceamento ao concluir esta análise.

ANÁLISE: A criptomoeda XRP encontra-se estável, segundo nossa inteligência artificial. Ajustes estratégicos nas alocações podem ser benéficos para aproveitar futuras oportunidades de crescimento, baseando-se em projeções de mercado. Explore as sugestões de realocação preparadas pela nossa I.A no encerramento desta análise.


Estas sugestões de ajustes não constitui uma recomendação direta de investimento.

**Análise Realizada de Longo Prazo**

Extrema CAUTELA! A análise de nossa inteligência artificial, apresenta a criptomoeda  com um patamar de extrema valorização. Baseando-se em diversos dados e informações, dentre elas: Indicadores, menções em redes sociais, análise de sentimento e várias outras, nossa inteligência artificial enxerga uma possibilidade de captura de lucros e reavaliação estratégica das posições atuais para esta cripto. Esse movimento poderia trazer novas oportunidades para o portfólio, buscando oportunidades com maior margem de crescimento. Nossa I.A irá te apresentar uma possibilidade de rebalanceamento ao final desta análise.

ALERTA MÁXIMO! A avaliação feita pela nossa I.A destaca a criptomoeda  num nível de valorização surpreendente. A partir de uma ampla gama de dados, incluindo análises de mercado, menções sociais e sentimentos, identificamos um forte potencial para a realização de lucros e ajustes estratégicos nas alocações atuais. Esta pode ser uma chance de diversificar o portfólio com ativos de alto crescimento. Fique atento às recomendações de rebalanceamento ao concluir esta análise.

ANÁLISE: A criptomoeda XRP encontra-se estável, segundo nossa inteligência artificial. Ajustes estratégicos nas alocações podem ser benéficos para aproveitar futuras oportunidades de crescimento, baseando-se em projeções de mercado. Explore as sugestões de realocação preparadas pela nossa I.A no encerramento desta análise.


Estas sugestões de ajustes não constitui uma recomendação direta de investimento.`;

const PDFDocument = require('pdfkit');
const fs = require('fs');
const path = require('path');

function save_and_convert_to_base64(doc, pdf_path) {
    return new Promise((resolve, reject) => {
        const stream = fs.createWriteStream(pdf_path);
        doc.pipe(stream);
        doc.end();

        stream.on('finish', () => {
            fs.readFile(pdf_path, { encoding: 'base64' }, (err, data) => {
                if (err) {
                    reject(err);
                } else {
                    resolve(data);
                }
            });
        });
    });
}

// Função auxiliar para adicionar fundo em cada página
function addPageBackground(doc) {
    const pageWidth = doc.page.width;
    const pageHeight = doc.page.height;

    // Define a cor azul claro. Exemplo: #ADD8E6 ou uma cor RGB equivalente
    const lightBlue = '#ADD8E6';

    // Desenha um retângulo que cobre toda a página com a cor definida
    doc.rect(0, 0, pageWidth, pageHeight).fill(lightBlue);
};

// Função auxiliar para adicionar cabeçalho em cada página
function addHeader(doc, imagePath) {
    const pageWidth = doc.page.width;
    const logoSize = { width: 30, height: 30 };
    const logoX = (pageWidth / 2) - (logoSize.width / 2);
    const logoY = 15;
    doc.image(imagePath, logoX, logoY, { width: logoSize.width, height: logoSize.height });
}

// Função para processar e adicionar texto ao documento
function addFormattedText(doc, text) {
    // Divide o texto em parágrafos
    const paragraphs = text.split('\n');

    paragraphs.forEach((paragraph, index) => {
        // Verifica se o parágrafo atual não é o primeiro e adiciona uma quebra de linha
        if (index > 0) {
            doc.moveDown(0.5); // Isso adiciona uma quebra de linha entre parágrafos
        }

        // Processa o negrito dentro do parágrafo
        const parts = paragraph.split('**');
        let isBold = false;

        parts.forEach(part => {
            if (part) { // Ignora strings vazias para evitar adicionar espaços extras
                if (isBold) {
                    // Parte em negrito
                    doc.font('Helvetica-Bold').text(part, { continued: true });
                } else {
                    // Parte normal
                    doc.font('Helvetica').text(part, { continued: true });
                }
            }
            // Alternar entre negrito e normal
            isBold = !isBold;
        });

        // Finaliza a parte atual no PDF, preparando para o próximo parágrafo
        // O 'continued: false' é importante para evitar que o texto do próximo parágrafo comece na mesma linha
        doc.text('', { continued: false });
    });
}

async function create_pdf() {
    const doc = new PDFDocument({
        size: 'A4',
        margins: { top: 60, bottom: 50, left: 72, right: 72 },
        bufferPages: true,
    });

    // Define o espaçamento de linha globalmente
    doc.lineGap(4); // Ajuste o valor conforme necessário

    const logoPath = 'uploads/logos/logo-dicascripto-laranja.png';

    doc.on('pageAdded', () => {
        addPageBackground(doc); // Adiciona o fundo azul claro
        addHeader(doc, logoPath);
        doc.font('Helvetica').fontSize(12).fillColor('black');
    });

    addPageBackground(doc); // Adiciona o fundo na primeira página antes do cabeçalho
    addHeader(doc, logoPath);

    // Adicione seu conteúdo aqui
    // doc.font('Helvetica-Bold').fontSize(14).fillColor('black');
    // doc.text('Texto em negrito aqui', 72, 75);

    // Supondo que "mensagem_enorme" seja uma variável definida em algum lugar do seu código:
    doc.font('Helvetica').fontSize(12).fillColor('black');
    // doc.text(mensagem_enorme, 72, 110, { continued: true });

    // Processar e adicionar o texto formatado
    addFormattedText(doc, mensagem_enorme);

    // Salva o arquivo PDF na pasta raiz do projeto e converte para base64
    const pdf_path = path.join(process.cwd(), 'output.pdf');
    return await save_and_convert_to_base64(doc, pdf_path);
}

create_pdf().then((base64_string) => {
    // console.log(base64_string); // Aqui você tem seu PDF em base64
}).catch((error) => {
    console.error("Ocorreu um erro ao criar o PDF:", error);
});